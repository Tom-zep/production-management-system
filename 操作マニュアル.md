# 生産管理システム 操作マニュアル

**バージョン: 1.0**  
**作成日: 2026年2月12日**

---

## 目次

1. [システム概要](#1-システム概要)
2. [基本操作](#2-基本操作)
3. [用語説明](#3-用語説明)
4. [各機能の詳細](#4-各機能の詳細)
5. [トラブルシューティング](#5-トラブルシューティング)

---

## 1. システム概要

### 1.1 システムの目的

生産管理システムは、営業計画・生産計画・在庫管理を一元管理し、データの可視化と分析を行うシステムです。

### 1.2 主な機能

| 機能 | 説明 |
|------|------|
| 営業計画入力 | Excelから営業計画データを取り込み、履歴管理 |
| 生産計画管理 | 版・改定管理、平準化分析 |
| ダッシュボード | HTMLでリアルタイム可視化 |
| クロス集計表 | 品番×月の計画数を表形式で表示 |
| マスタ管理 | 製品・担当者情報の管理 |

### 1.3 メインメニュー

システム起動時に表示されるメインメニューから、各機能にアクセスできます。

**メインメニューの構成:**

- **左列**: 計画確認・分析系
  - 生産計画一覧
  - 月次推移グラフ
  - 版改定比較
  - 営業計画入力
  - レポート印刷
  - クロス集計表
  - 在庫CSV出力→Python分析用
  - マスタ管理（管理者用）

- **右列**: 計画作成・更新系
  - 生産計画数を計算
  - 単価更新
  - 負荷グラフ
  - 生産計画作成
  - ダッシュボード更新
  - KPI進捗状況
  - 生産計画平準化
  - 営業計画ダッシュボード

---

## 2. 基本操作

### 2.1 営業計画の入力（最頻繁に使用）

営業計画の入力は、本システムで最も頻繁に使用する機能です。

#### 手順

**ステップ1: 営業計画入力画面を開く**

1. メインメニューから「**営業計画入力**」ボタンをクリック
2. 営業計画入力画面が開きます

**ステップ2: フィルタを設定**

画面上部のフィルタで表示内容を絞り込めます:

- **年**: 対象年度を選択（例: 2026）
- **担当者**: 特定の担当者のみ表示する場合に選択
- **入力日選択**: 空白（最新データ）または過去の日付を選択

**ステップ3: Excelテンプレートを準備**

営業計画データは、Excelテンプレートで準備します。

**テンプレート形式（横持ち）:**

| 品番 | 品名 | 4月 | 5月 | 6月 | 7月 | 8月 | 9月 | 10月 | 11月 | 12月 | 1月 | 2月 | 3月 |
|------|------|-----|-----|-----|-----|-----|-----|------|------|------|-----|-----|-----|
| A-001 | 製品A | 100 | 150 | 200 | ... | ... | ... | ... | ... | ... | ... | ... | ... |
| B-002 | 製品B | 200 | 220 | 180 | ... | ... | ... | ... | ... | ... | ... | ... | ... |

**重要:**
- 1行目: 見出し（品番、品名、4月〜3月）
- 2行目以降: データ
- 月は「4月」「5月」...「3月」の形式
- 数値以外のセルは0として扱われます

**ステップ4: Excelファイルを取り込む**

1. 「**エクセル取込**」ボタンをクリック
2. ファイル選択ダイアログが開く
3. 準備したExcelファイルを選択
4. 「開く」をクリック
5. データが自動的に取り込まれます

**取込完了メッセージ:**
```
○○件のデータを取り込みました。
```

**ステップ5: データを確認**

取り込み後、画面に2つの表が表示されます:

- **上部の表**: 最新データ（今回取り込んだデータ）
- **下部の表**: 変更比較（前回からの差分）
  - 青色の数値: 前回からの変更がある項目
  - 増加: 正の数値
  - 減少: 負の数値

#### 注意事項

- **同じ月に複数回取り込む場合**: 同じ「アップロード年月」のデータは上書きされます
- **履歴管理**: すべての取込履歴が保存されます（入力日で区別）
- **担当者の紐付け**: 品番マスタの担当IDに基づいて自動設定されます

---

### 2.2 ダッシュボードの確認

HTMLダッシュボードで、計画データを視覚的に確認できます。

#### 生産計画ダッシュボード

**起動方法:**
1. メインメニューから「**ダッシュボード更新**」をクリック
2. HTMLファイルが生成され、ブラウザで自動的に開きます

**表示内容:**
- **KPI表示**: 営業計画数・生産計画数・負荷金額の合計
- **前版比較**: 前の版・改定との増減率（%）
- **工場別負荷グラフ**: 3工場（恵州・フィリピン・東莞）の月次推移
- **工場別シェア**: 円グラフで工場別の負荷割合を表示

**操作:**
- **版・改定選択**: プルダウンで過去のデータに切り替え
- **工場フィルタ**: チェックボックスで特定工場のみ表示
- **印刷**: 印刷ボタンでPDF出力

#### 営業計画ダッシュボード

**起動方法:**
1. メインメニューから「**営業計画ダッシュボード**」をクリック
2. HTMLファイルが生成され、ブラウザで開きます

**表示内容:**
- **品番別月次クロス集計表**: 品番×月の計画数
- **変更比較**: 前回入力との差分
- **履歴一覧**: 過去のアップロード履歴

**操作:**
- **年度・担当者フィルタ**: プルダウンで絞り込み
- **入力日スライダー**: 過去のデータに遡る
- **タブ切り替え**: 最新データ / 変更比較 / 履歴一覧

---

### 2.3 マスタの検索・編集

製品マスタと担当者マスタは、分割フォーム形式で管理します。

#### 製品マスタ管理

**起動方法:**
1. メインメニュー → 「**マスタ管理（管理者用）**」
2. マスタメニュー → 「**製品マスタ管理**」

**検索方法:**
1. 画面上部の「品番または品名」欄に検索キーワードを入力
2. 自動的に部分一致で絞り込まれます
3. 「全件表示」ボタンで絞り込みを解除

**編集方法:**
1. 下部の一覧から編集したい製品をクリック
2. 上部の編集エリアに内容が表示される
3. 内容を修正
4. 別のレコードをクリックすると自動保存

**新規追加:**
1. 「新規追加」ボタンをクリック
2. 上部の編集エリアが空白になる
3. 必要事項を入力
4. 別のレコードをクリックすると自動保存

**削除（管理者のみ）:**
1. 削除したいレコードを選択
2. 「削除」ボタン（赤色）をクリック
3. 確認メッセージで「はい」を選択

---

## 3. 用語説明

### 3.1 版・改定とは？

**版（はん）:**
- 生産計画の大きなバージョン番号
- 通常、月ごとに版が上がります
- 例: 1版、2版、3版...

**改定（かいてい）:**
- 同じ版の中での修正番号
- 計画を微調整する度に改定番号が上がります
- 例: 1版0改定、1版1改定、1版2改定...

**使い分けの例:**
```
4月の計画作成    → 4版0改定
↓
4月中に微調整    → 4版1改定
↓
5月の計画作成    → 5版0改定
```

**なぜ版・改定で管理するのか？**
- 過去の計画との比較が容易
- 変更履歴を追跡できる
- どの時点の計画か明確になる

---

### 3.2 その他の用語

| 用語 | 説明 |
|------|------|
| クロス集計表 | 品番（縦軸）×月（横軸）の表形式データ |
| 負荷金額 | 生産計画数 × 単価で計算される工場の負荷 |
| 平準化 | 生産量の月ごとのバラつきを減らすこと |
| 変動係数（CV） | バラつきの程度を示す指標（小さいほど平準） |
| アップロード年月 | データを取り込んだ年月（履歴管理に使用） |
| 入力日 | データを取り込んだ日時（履歴管理に使用） |

---

## 4. 各機能の詳細

### 4.1 生産計画一覧
- 生産計画データを一覧表示
- フィルタ・ソート機能あり

### 4.2 生産計画数を計算
- 営業計画から生産計画への変換
- 安全在庫を考慮した計算

### 4.3 月次推移グラフ
- 品番別の月次推移をグラフ表示
- 複数品番の比較可能

### 4.4 単価更新
- 製品マスタの単価を一括更新
- CSVインポート対応

### 4.5 版改定比較
- 異なる版・改定のデータを比較
- 差分を色分け表示

### 4.6 負荷グラフ
- 工場別の負荷金額をグラフ表示
- 月次推移を確認

### 4.7 生産計画作成
- 新しい版・改定の計画を作成
- 営業計画データを元に自動生成

### 4.8 レポート印刷
- 各種レポートの印刷機能
- PDF出力対応

### 4.9 クロス集計表
- 品番×月のクロス集計表をHTML出力
- 担当者・工場でフィルタ可能
- 前版との差分表示

### 4.10 KPI進捗状況
- 目標に対する進捗をKPI表示
- 達成率の可視化

### 4.11 在庫CSV出力→Python分析用
- 在庫データをCSV形式で出力
- Google Colabでの分析用

### 4.12 生産計画平準化
- 変動係数（CV）を計算
- 平準化案を自動生成
- HTMLレポート出力

---

## 5. トラブルシューティング

### Q1: Excelファイルが取り込めない

**原因:**
- ファイル形式が正しくない（.xlsx形式でない）
- テンプレートの形式が違う（縦持ちになっている）
- 見出し行がない、または形式が違う

**解決方法:**
1. ファイルを開いて、テンプレート形式を確認
2. 1行目が「品番、品名、4月、5月...3月」になっているか確認
3. 数値が入力されているか確認（空白セルは0として扱われる）

---

### Q2: データが表示されない

**原因:**
- フィルタで絞り込まれている
- 該当データが存在しない

**解決方法:**
1. 年度・担当者・入力日のフィルタを確認
2. 「全て」または空白に設定して再表示
3. データが正しく取り込まれているか確認

---

### Q3: 変更比較に差分が表示されない

**原因:**
- 前回のデータが存在しない（初回取込）
- 前回と全く同じデータを取り込んだ

**解決方法:**
- 初回取込の場合は正常（比較対象がない）
- 2回目以降は、データに変更があれば差分が表示されます

---

### Q4: ダッシュボードが開かない

**原因:**
- HTMLファイルが生成されていない
- ブラウザの設定でブロックされている

**解決方法:**
1. 「ダッシュボード更新」ボタンをもう一度クリック
2. 生成先フォルダを確認
3. HTMLファイルを手動でダブルクリックして開く

---

### Q5: マスタの削除ボタンが表示されない

**原因:**
- 管理者権限がない

**解決方法:**
- 削除は管理者のみ実行できます
- 権限が必要な場合は、システム管理者に連絡してください

---

### Q6: 版・改定の意味が分からない

**解決方法:**
- 「3.1 版・改定とは？」の説明を参照してください
- 簡単に言うと:
  - **版**: 月ごとの大きな番号
  - **改定**: その月の中での修正番号

-

---

**マニュアル作成日: 2026年2月12日**  
**バージョン: 1.0**
