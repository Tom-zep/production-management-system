# 生産管理システム 要件定義書

## 1. システム概要

### 1.1 システム名
生産管理システム（Production Management System）

### 1.2 開発期間
2024年4月〜2025年2月（10ヶ月）

### 1.3 開発者
52歳、実務経験者、AI（Claude）活用

### 1.4 技術スタック
- **データベース**: Microsoft Access
- **開発言語**: VBA
- **分析**: Python（pandas, matplotlib, Plotly）
- **可視化**: HTML/CSS/JavaScript（Chart.js）
- **環境**: Google Colab

---

## 2. 開発の背景

### 2.1 現状の課題
製造業の現場において、以下の課題が存在していた:

1. **データベース管理の非効率性**
   - Excelベースでの管理
   - データが散在し、一元管理ができていない
   - 履歴管理が手作業で煩雑

2. **工数の増大**
   - 集計・分析に多大な時間を要する
   - 手作業によるミスのリスク
   - 版改定管理が複雑

3. **可視化の欠如**
   - リアルタイムでの状況把握が困難
   - グラフ作成が手作業
   - 比較分析に時間がかかる

4. **平準化の困難さ**
   - 生産負荷の偏りが見えにくい
   - 調整判断に時間がかかる

### 2.2 システム化の目的
上記課題を解決し、以下を実現する:
- データの一元管理
- 履歴管理の自動化
- 工数削減
- HTMLでのリアルタイム可視化
- 生産平準化の容易化

---

## 3. システム要件

### 3.1 機能要件

#### 3.1.1 営業計画管理
- **営業計画入力**
  - Excelテンプレートからの一括取込
  - 品番別・月次計画数の入力
  - 担当者別管理
  
- **履歴管理**
  - 入力日ごとの自動保存
  - 過去データの参照機能
  - 変更履歴の追跡

- **変更比較**
  - 前回入力との差分表示
  - 増減の自動計算
  - 色分け表示（増加=緑、減少=赤）

#### 3.1.2 生産計画管理
- **生産計画作成**
  - 営業計画からの自動変換
  - 版・改定管理
  - 平準化分析

- **版改定比較**
  - 複数版の比較機能
  - 前版との差異表示
  - KPI進捗管理

#### 3.1.3 マスタ管理
- **製品マスタ**
  - 品番・品名・工場・担当者
  - 単価・安全在庫管理
  - 検索・フィルタ機能

- **担当者マスタ**
  - 担当者情報管理
  - アクティブ/非アクティブ管理

#### 3.1.4 在庫管理
- **在庫データ管理**
  - 期首在庫・入庫・出庫・期末在庫
  - 安全在庫との比較
  - CSV出力（Python分析用）

#### 3.1.5 ダッシュボード・可視化
- **生産計画ダッシュボード**
  - 工場別負荷グラフ（棒グラフ・円グラフ）
  - KPI表示（営業計画数・生産計画数・負荷金額）
  - 前版比較
  - 工場フィルタ機能

- **営業計画ダッシュボード**
  - 品番別月次クロス集計表
  - 変更比較表
  - アップロード履歴一覧
  - 入力日スライダー（過去遡及）
  - 担当者・年度フィルタ

- **クロス集計表**
  - 品番×月の計画数表示
  - 担当者・工場別フィルタ
  - 前版との差分表示

#### 3.1.6 分析機能
- **平準化分析**
  - 変動係数（CV）計算
  - 移動平均による平準化
  - 削減率の自動判定
  - HTMLレポート出力

### 3.2 非機能要件

#### 3.2.1 性能要件
- データ取込: 1,000件/分以上
- 画面表示: 3秒以内
- HTML生成: 5秒以内

#### 3.2.2 操作性要件
- メインメニューから全機能へワンクリックアクセス
- 直感的なUI
- フィルタ・検索機能の充実

#### 3.2.3 保守性要件
- VBAコードのモジュール化
- コメントの充実
- エラーハンドリングの実装

---

## 4. データベース設計

### 4.1 テーブル一覧

| テーブル名 | 役割 | レコード数（例） |
|-----------|------|----------------|
| T-製品 | 製品マスタ | 455件 |
| T-担当 | 担当者マスタ | 10件 |
| T-営業計画 | 営業計画トランザクション | 5,000件 |
| T-営業計画アップロード履歴 | アップロード履歴 | 100件 |
| T-生産計画 | 生産計画トランザクション | 5,000件 |
| T-在庫管理 | 在庫データ | 500件 |
| T-生産実績 | 生産実績データ | 1,000件 |

### 4.2 ER図
別添ファイル: `ER図.png`

---

## 5. 画面一覧

| 画面名 | 機能 | アクセス方法 |
|--------|------|-------------|
| F-メインメニュー | 機能選択 | システム起動時 |
| F-営業計画入力 | 営業計画の入力・表示 | メニューから |
| F-製品マスタ管理 | 製品情報の管理 | メニュー→マスタ管理 |
| F-担当者マスタ管理 | 担当者情報の管理 | メニュー→マスタ管理 |
| dashboard.html | 生産計画ダッシュボード | メニュー→ダッシュボード更新 |
| eigyo_dashboard.html | 営業計画ダッシュボード | メニュー→営業計画ダッシュボード |
| crosstable.html | クロス集計表 | メニュー→クロス集計表 |

---

## 6. 期待される効果

### 6.1 工数削減
- **集計作業**: 手作業2時間 → 自動化5秒（**99.9%削減**）
- **グラフ作成**: 30分 → 5秒（**99%削減**）
- **変更比較**: 1時間 → 即時（**100%削減**）

### 6.2 品質向上
- 手作業ミスの撲滅
- リアルタイムでの状況把握
- データの整合性確保

### 6.3 意思決定の迅速化
- HTMLダッシュボードで即座に可視化
- フィルタ機能で多角的分析
- 平準化の容易化

### 6.4 コスト削減
- 外注開発費: **500〜700万円削減**
- 年間保守費: **50〜100万円削減**

---

## 7. 今後の展開

### 7.1 短期（3ヶ月以内）
- 操作マニュアル整備
- ユーザートレーニング
- 微調整・改善

### 7.2 中期（6ヶ月〜1年）
- 在庫管理機能の強化
- モバイル対応
- ユーザー権限管理

### 7.3 長期（1年以上）
- SQLサーバーへの移行
- Web API化
- Python/Flaskでの再構築
- クラウド化

---

## 8. 添付資料

1. ER図（mermaid-diagram-2026-02-12-084827.png）
2. 操作マニュアル（別途作成）
3. 画面キャプチャ集（別途作成）

---

**作成日: 2026年2月12日**
**バージョン: 1.0**
